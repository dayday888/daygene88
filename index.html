<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Generator Kombinasi Lengkap</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-image: url('effect.png'); /* Gambar lokal di folder yang sama */
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      color: white;
      padding: 20px;
    }

    h2 {
      text-align: center;
    }

    .section {
      border: 1px solid #ccc;
      background: rgba(36, 90, 128, 0.85); /* transparan agar background terlihat */
      margin: 20px auto;
      padding: 20px;
      border-radius: 8px;
      max-width: 600px;
    }

    .form-group, .bet-group {
      max-width: 500px;
      margin: 10px auto;
      display: flex;
      align-items: center;
    }

    .form-group label, .bet-group label {
      width: 100px;
      font-weight: bold;
    }

    .form-group input, .bet-group input, select {
      flex: 1;
      height: 30px;
      font-size: 16px;
      margin-left: 10px;
      padding: 5px;
      border: none;
      border-radius: 5px;
    }

    textarea {
      width: 100%;
      margin-top: 10px;
      height: 150px;
      font-size: 14px;
      border-radius: 5px;
    }

    button, input[type="button"], input[type="submit"] {
      padding: 10px 20px;
      margin: 10px 5px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      background-color: #3380a1;
      color: white;
      cursor: pointer;
    }

    table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
      background: rgba(16, 51, 71, 0.85);
    }

    th, td {
      border: 1px solid #ffffff22;
      padding: 8px;
      text-align: center;
    }

    th {
      background-color: #1f5d7a;
    }
  </style>
</head>
<body>
  <div class="container">

    <!-- üîÅ Generator Kombinasi Bolak Balik -->
    <div class="section">
      <h2>üîÅ Generator Kombinasi Bolak Balik</h2>
      <form name="interfaceform">
        <div class="form-group">
          <label>Angka:</label>
          <input maxlength="10" name="inputstring" type="text" placeholder="contoh: 1234">
        </div>
        <div class="form-group">
          <label>Panjang:</label>
          <select name="maxwidth">
            <option value="2">2D</option>
            <option value="3">3D</option>
            <option value="4" selected>4D</option>
          </select>
          <select id="select1">
            <option value="">Tanpa pemisah</option>
            <option value="*">*</option>
            <option value="#">#</option>
          </select>
        </div>
        <div class="form-group center">
          <input onclick="GeneratePermutations()" type="button" value="Generate">
          <input onclick="ClearReset()" type="button" value="Bersihkan">
        </div>
        <div class="form-group">
          <input name="feedback" readonly style="border: none; background: none; font-weight: bold; color: #ff0;">
        </div>
        <textarea name="permlist" placeholder="Hasil kombinasi..."></textarea>
      </form>
    </div>

    <!-- üî• Generator Kombinasi AS-KOP-KEPALA-EKOR -->
    <div class="section">
      <h2>üî• Kombinasi AS - KOP - KEPALA - EKOR</h2>
      <form oninput="str.value = AS.value + ',' + COP.value + ',' + KEP.value + ',' + EKOR.value"
            onsubmit="return combineApp.calcCombinations({src:this.str,dest:this.txt,msgID:'count'});">
        <div class="form-group"><label>AS:</label><input name="AS" type="text"></div>
        <div class="form-group"><label>KOP:</label><input name="COP" type="text"></div>
        <div class="form-group"><label>KEPALA:</label><input name="KEP" type="text"></div>
        <div class="form-group"><label>EKOR:</label><input name="EKOR" type="text"></div>
        <div class="form-group"><label>Pemisah:</label>
          <select id="select2">
            <option value="">Tanpa pemisah</option>
            <option value="*">*</option>
            <option value="#">#</option>
          </select>
        </div>
        <input id="str" name="str" type="hidden">
        <div class="form-group center">
          <input type="submit" value="Generate">
          <input type="button" onclick="trimSpaces()" value="Hapus Spasi">
        </div>
        <div class="form-group"><b><i id="count">Belum ada kombinasi üî•</i></b></div>
        <textarea id="textString" name="txt"></textarea>
      </form>
    </div>

    <!-- üí∞ Total Tebakan dan Biaya -->
    <div class="section">
      <h2>üí∞ Hitung Total Tebakan</h2>
      <div class="form-group"><label>AS:</label><input id="r1" type="text"></div>
      <div class="form-group"><label>KOP:</label><input id="r2" type="text"></div>
      <div class="form-group"><label>KEPALA:</label><input id="r3" type="text"></div>
      <div class="form-group"><label>EKOR:</label><input id="r4" type="text"></div>

      <div class="bet-group">
        <label>4D: <input id="beli-4dset" value="100"></label>
        <label>3D: <input id="beli-3dset" value="100"></label>
        <label>2D: <input id="beli-2dset" value="100"></label>
      </div>

      <div class="form-group center">
        <button onclick="generateCombinations()">Proses Hitung</button>
      </div>

      <div id="output"></div>
    </div>

  </div>

  <!-- Script Semua Fitur -->
  <script>
    function GeneratePermutations() {
      const form = document.forms['interfaceform'];
      const input = form.inputstring.value.trim();
      const maxWidth = parseInt(form.maxwidth.value);
      const separator = document.getElementById('select1').value;
      const resultArea = form.permlist;
      const feedback = form.feedback;

      if (!input || input.length < maxWidth) {
        feedback.value = "‚ö†Ô∏è Masukkan angka minimal sepanjang " + maxWidth + " digit.";
        resultArea.value = "";
        return;
      }

      let results = getPermutations(input, maxWidth);
      if (separator) {
        results = results.map(val => val.split('').join(separator));
      }

      resultArea.value = results.join("\n");
      feedback.value = results.length + " kombinasi";
    }

    function ClearReset() {
      const form = document.forms['interfaceform'];
      form.inputstring.value = "";
      form.permlist.value = "";
      form.feedback.value = "";
    }

    function getPermutations(input, length) {
      const result = new Set();
      function permute(path, used) {
        if (path.length === length) {
          result.add(path.join(''));
          return;
        }
        for (let i = 0; i < input.length; i++) {
          if (used[i]) continue;
          used[i] = true;
          path.push(input[i]);
          permute(path, used);
          path.pop();
          used[i] = false;
        }
      }
      permute([], []);
      return Array.from(result);
    }

    const combineApp = {
      calcCombinations: function({ src, dest, msgID }) {
        let values = src.value.split(",").map(x => x.trim());
        let [as, kop, kep, ekor] = values;
        const op = document.getElementById("select2").value;
        let result = [];

        if (as && kop && kep && ekor) {
          for (let a of as) for (let k of kop) for (let h of kep) for (let e of ekor)
            result.push(`${a}${op}${k}${op}${h}${op}${e}`);
          document.getElementById(msgID).innerHTML = `${result.length} kombinasi 4D`;
        } else if (!as && kop && kep && ekor) {
          for (let k of kop) for (let h of kep) for (let e of ekor)
            result.push(`${k}${op}${h}${op}${e}`);
          document.getElementById(msgID).innerHTML = `${result.length} kombinasi 3D`;
        } else if (!as && !kop && kep && ekor) {
          for (let h of kep) for (let e of ekor)
            result.push(`${h}${op}${e}`);
          document.getElementById(msgID).innerHTML = `${result.length} kombinasi 2D`;
        } else {
          document.getElementById(msgID).innerHTML = "Isi minimal KEPALA dan EKOR!";
        }

        dest.value = result.join("\n");
        return false;
      }
    };

    function trimSpaces() {
      const txt = document.getElementById("textString");
      txt.value = txt.value.replace(/\s+/g, "");
    }

    function cartesian(arrays) {
      return arrays.reduce((a, b) => a.flatMap(d => b.map(e => d + e)));
    }

    function generateCombinations() {
      const as = document.getElementById('r1').value.split('');
      const kop = document.getElementById('r2').value.split('');
      const kepala = document.getElementById('r3').value.split('');
      const ekor = document.getElementById('r4').value.split('');

      const beli4d = parseInt(document.getElementById('beli-4dset').value || 0);
      const beli3d = parseInt(document.getElementById('beli-3dset').value || 0);
      const beli2d = parseInt(document.getElementById('beli-2dset').value || 0);

      const comb4D = cartesian([as, kop, kepala, ekor]);
      const comb3D = cartesian([kop, kepala, ekor]);
      const comb2Ddpn = cartesian([as, kop]);
      const comb2Dtgh = cartesian([kop, kepala]);
      const comb2Dblkg = cartesian([kepala, ekor]);

      const format = (arr, perLine = 10) => arr.map((v, i) => ((i % perLine === 0 && i !== 0) ? '\n' : '') + v).join(' : ');

      document.getElementById("output").innerHTML = `
      <table>
        <tr><th>Jumlah</th><th>Kombinasi</th><th>Total</th></tr>
        <tr><td>${comb4D.length}</td><td>${format(comb4D)}</td><td>${beli4d} x ${comb4D.length} = ${beli4d * comb4D.length}</td></tr>
        <tr><td>${comb3D.length}</td><td>${format(comb3D)}</td><td>${beli3d} x ${comb3D.length} = ${beli3d * comb3D.length}</td></tr>
        <tr><td>2D Depan ${comb2Ddpn.length}</td><td>${format(comb2Ddpn)}</td><td>${beli2d} x ${comb2Ddpn.length} = ${beli2d * comb2Ddpn.length}</td></tr>
        <tr><td>2D Tengah ${comb2Dtgh.length}</td><td>${format(comb2Dtgh)}</td><td>${beli2d} x ${comb2Dtgh.length} = ${beli2d * comb2Dtgh.length}</td></tr>
        <tr><td>2D Belakang ${comb2Dblkg.length}</td><td>${format(comb2Dblkg)}</td><td>${beli2d} x ${comb2Dblkg.length} = ${beli2d * comb2Dblkg.length}</td></tr>
      </table>`;
    }
  </script>
</body>
</html>
